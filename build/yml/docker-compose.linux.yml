version: '3'

services:
  sql.data:
    image: microsoft/mssql-server-linux:2017-latest
    restart: on-failure
  rabbitmq:
    image: rabbitmq:3-management-alpine
    restart: on-failure
  muncode.merp.accounting.api:
    image: muncode.merp.accounting.api
    restart: on-failure
    build:
      context: ../output
      dockerfile: muncode.merp.accounting.api.df
    depends_on:
      - sql.data
      - rabbitmq
  muncode.merp.sales.api:
    image: muncode.merp.sales.api
    restart: on-failure
    build:
      context: ../output
      dockerfile: muncode.merp.sales.api.df
    depends_on:
      - sql.data
      - rabbitmq
  muncode.merp.gateway:
    image: muncode.merp.gateway
    restart: on-failure
    build:
      context: ../output
      dockerfile: muncode.merp.gateway.df
    depends_on:
      - muncode.merp.sales.api
      - muncode.merp.accounting.api
      - rabbitmq